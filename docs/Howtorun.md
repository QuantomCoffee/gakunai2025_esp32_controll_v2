# 機体の動かし方
[!コントローラー配置図](./controller_layout.png)
## 起動・終了マニュアル
### 起動時
1. 非常停止ボタンを押す
2. 必要であれば、プログラムを書き込む
3. 機体に異常がないか確認する
4. バッテリーコネクタをつなげる
5. ESP32にUSB端子を取り付ける
6. コントローラーをつなげる
7. コントローラーが**青色以外に光ったら**緊急停止ボタンを解除する
- 補足: 4,5の順番は任意
### 終了時
1. 緊急停止ボタンを押す
2. ESP32のUSB端子を取り外す
3. バッテリーコネクタを取り外す
4. 機体に異常がないか確認する
5. コントローラーを定位置に戻す(または次の使用チームに渡す)
- 補足: 2,3の順番は任意
### 追加の注意事項
#### 起動3/終了4: 機体チェックシート
- 最重要事項
  - [ ] MD, 端子台の配線は端子にちゃんとはまっていますか？
    - [ ] 特に端子台->MDの配線が抜けている可能性あり。**この場合はショートによる事故(発煙/発火)の危険性があるため、緊急停止ボタンを押して、それ以上触らずすぐに担当者を呼び出すこと。**
    - [ ] 端子台、電源配線には基本触らないこと。万一触る場合は必ずバッテリーを取り外して緊急停止ボタンを押しておくこと。
  - [ ] 通信ピンはきちんとつながっていますか？
    - [ ] TX-RX (16,17番ピン) 白黒ジャンパー線は、**ESP 2台で色が逆になるよう取り付ける**
    - [ ] もし自動化が必要であれば、通信ケーブルは別途指示の通り取り付ける
    - [ ] アームを動かす際、4つつながってるジャンパーピンを、GNDが赤に来るよう接続
    - [ ] MD関係は基本**5ピンが横並びになって隣or近くに刺さっている**。もし4つ以下なら要確認
    - [ ] わからないことがあれば担当者に確認すること
- 余裕があれば確認
  - [ ] 動作確認したい部品があれば：その部品は正常に取り付けられていますか？
#### 起動2: 書き込みについて
##### How to かんたんぷろぐらむかきこみ
1. 書き込みたいプログラムを選びます
  - このとき、`/test/beta/`から持ってきてください。alphaは更新終了済みです。
2. 適切な端末を選ぶ
  - 2つのESPへつながってるジャンパ戦の数を比較してください。<br>少ないほうが`main`、多いほうが`lower`です。


##### パソコン側のトラブル
- このレポジトリはGitとPlatformioを使えば高確率でうまくインストールできるはず...です。
  - zipファイルでダウンロードしてから作るのは非常に面倒です。やめておきましょう。
  - Portable GitはGithubから直接データを持ってくるのに非常に便利です。関係なくパソコンにぶち込んでおきましょう。
  - ここら辺を考えずに使いたい場合はGithub Desktopが便利です。良ければ使ってみてください。
- 書き込み前に、当該プログラムを/src/に突っ込んでビルドできるか確認してください。
  - できない場合は何か足りないか、SCServoのライブラリを入れていないか、もしくは担当者のミスです。
- **念のため、書き込み中は非常停止ボタンを押して機体を停止させてください。コントローラーの様子やプログラムの設定によっては自動で起動して走行し始めます。**
##### 機体側のトラブル
- TX-RX (16,17番ピン) 白黒ジャンパー線、FE-URT配線(4連オス-メスケーブルのメス端子側)、自律制御 (上側1,3番ピン) 配線 は、書き込み開始前に取り外してください。
  - TX-RX (16,17番ピン) 白黒ジャンパー線、自律制御 (上側1,3番ピン) 配線が書き込み時に接続されていると書き込みができなくなります。(なんでも内部的にリセットするピンと混線するとかなんとか)
  - FE-URT配線は取り外さなくても書き込みには成功します。が、想定外の通信が行われる可能性がぬぐえないのであまりやらないほうがいいかと。
- v0.5.000.2までのmain.cppでは、場合によっては書き込み前にErase Flash操作が必要で**した**。
  - 現在は不要です。