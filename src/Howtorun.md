# 機体の動かし方

## 起動・終了マニュアル
### 起動時
1. 必要であれば、プログラムを書き込む
2. 機体に異常がないか確認する
3. 非常停止ボタンを押す
4. バッテリーコネクタをつなげる
5. ESP32にUSB端子を取り付ける
6. コントローラーをつなげる
7. コントローラーが**青色以外に光ったら**緊急停止ボタンを解除する
- 補足: 4,5の順番は任意
### 終了時
1. 緊急停止ボタンを押す
2. ESP32のUSB端子を取り外す
3. バッテリーコネクタを取り外す
4. 機体に異常がないか確認する
5. コントローラーを定位置に戻す(または次の使用チームに渡す)
- 補足: 2,3の順番は任意
### 追加の注意事項
#### 起動2/終了4: 機体チェックシート
- 最重要事項
  - [ ] MD, 端子台の配線は端子にちゃんとはまっていますか？
    - [ ] 特に端子台->MDの配線が抜けている可能性あり。**この場合はショートによる事故(発煙/発火)の危険性があるため、緊急停止ボタンを押して、それ以上触らずすぐに担当者を呼び出すこと。**
    - [ ] 端子台、電源配線には基本触らないこと。万一触る場合は必ずバッテリーを取り外して緊急停止ボタンを押しておくこと。
  - [ ] 通信ピンはきちんとつながっていますか？
    - [ ] TX-RX (16,17番ピン) 白黒ジャンパー線は、**ESP 2台で色が逆になるよう取り付ける**
    - [ ] もし自動化が必要であれば、通信ケーブルは別途指示の通り取り付ける
    - [ ] アームを動かす際、4つつながってるジャンパーピンを、GNDが赤に来るよう接続
    - [ ] MD関係は基本**5ピンが横並びになって隣or近くに刺さっている**。もし4つ以下なら要確認
    - [ ] わからないことがあれば担当者に確認すること
- 余裕があれば確認
  - [ ] 動作確認したい部品があれば：その部品は正常に取り付けられていますか？
#### 起動1: 書き込みにおけるトラブルシューティング
- TX-RX (16,17番ピン) 白黒ジャンパー線、FE-URT配線(4連オス-メスケーブルのメス端子側)、自律制御 (上側1,3番ピン) 配線 は、書き込み開始前に取り外すこと。
  - TX-RX (16,17番ピン) 白黒ジャンパー線、自律制御 (上側1,3番ピン) 配線が書き込み時に接続されていると書き込みができない。
  - FE-URT配線は取り外さなくても書き込みには成功する。が、想定外の通信が行われる可能性がぬぐえないのであまりよくない。
- v0.5.000.2までのmain.cppでは、場合によっては書き込み前にErase Flash操作が必要。
  - Flashの特定の領域がバグる場合があり、それによりコントローラーが接続できない状況が生まれる。
  - v0.5.000.3以降では、特別な操作は不要。上記の特定領域が自動で消去され、接続できるようになるコードを組み込んでいる。